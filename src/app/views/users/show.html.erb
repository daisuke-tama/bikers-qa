<!-- 画面左側のメニュー欄 -->
<div class="navber-editer" style="width: 20%;">
  <div class="card-body">
    <% if @user.profile.blank? %>
      <%= image_tag '/assets/profile_defalt.png', class: "profile-image" %>
    <% else %>
      <%= image_tag @user.profile.url, class: "profile-image"%>
    <% end %>
    <h5 class="card-title username-font"><%= @user.name %></h5>
    <div class="relationship-link-text">
      <%= link_to follows_user_path(@user.id) do %>
        <p><%= @user.followings.count %></p>
        <p>フォロー</p>
      <% end %>
      <%= link_to followers_user_path(@user.id) do %>
        <p><%= @user.followers.count %></p>
        <p>フォロワー</p>
      <% end %>
    </div>
    <h5 style="font-size: 15px;"><%= @user.introduce %></h5>
    <% if @user == current_user %>
      <%= link_to 'プロフィールを編集する', edit_user_registration_path, class: "btn btn-outline-success edit-user-btn" %>
    <% end %>
    <div id="relation_buttons_<%= @user.id %>">
      <%= render 'relationships/relationship', user: @user %>
    </div>
  </div>
</div>

<!-- 投稿・お気に入りした記事一覧 -->
<div class="article-index-main-contents mb-50">
  <div class="content-width" style="width: 60%;">
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item">
        <a class="nav-link active" id="create-articles-tub" data-toggle="tab" href="#create-articles" role="tab" aria-controls="create-articles" aria-selected="true">作成した記事</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="favorites-tub" data-toggle="tab" href="#favorites" role="tab" aria-controls="favorites" aria-selected="false">お気に入り</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="questions-tub" data-toggle="tab" href="#questions" role="tab" aria-controls="questions" aria-selected="false">作成した質問</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="answers-tub" data-toggle="tab" href="#answers" role="tab" aria-controls="answers" aria-selected="false">回答した質問</a>
      </li>
    </ul>
    <!-- 作成した記事一覧 -->
    <div class="tab-content" id="myTabContent">
      <div class="tab-pane fade show active" id="create-articles" role="tabpanel" aria-labelledby="create-articles-tub">
        <% @articles.each do |article| %>
          <div class="card-custom">
            <div class="card-body">
              <div class="author-header contents-tidy">
                <div>
                  <%= link_to user_path(article.user_id) do %>
                    <% if article.user.profile? %>
                      <span style="margin-right: 5px;"><%= image_tag article.user.profile.url, class: "navber-profile-icon" %></span>
                    <% else %>
                      <span style="margin-right: 5px;"><%= image_tag '/assets/profile_defalt.png', class: "navber-profile-icon" %></span>
                    <% end %>
                    <%= article.user.name %>
                  <% end %>
                  さんが<%= article.updated_at.strftime("%Y年%m月%d日").to_s %>に作成 
                </div>         
                <div>
                  <i class="fas fa-heart favorite-icon"></i>✖<%= article.favorites.count %>
                </div>
              </div>
              <%= link_to article do %>
                <h5 class="card-title article-title-text"><%= article.title %></h5>
              <% end %>
              <%= strip_tags(article.content.to_s).gsub(/[\n]/,"").truncate(100) %>
            </div>
          </div>
        <% end %>
        <!-- kaminari ページネイション -->
        <%= paginate @articles %>
      </div>
      <!-- お気に入りした記事一覧 -->
      <div class="tab-pane fade" id="favorites" role="tabpanel" aria-labelledby="favorites-tub">
        <% @favorite_articles.each do |article| %>
          <div id="user_favorite_buttons_<%= article.id %>">
            <div class="card-custom">
              <div class="card-body">
                <div class="author-header contents-tidy">
                  <div>
                    <%= link_to user_path(article.user_id) do %>
                      <% if article.user.profile? %>
                        <span style="margin-right: 5px;"><%= image_tag article.user.profile.url, class: "navber-profile-icon" %></span>
                      <% else %>
                        <span style="margin-right: 5px;"><%= image_tag '/assets/profile_defalt.png', class: "navber-profile-icon" %></span>
                      <% end %>
                      <%= article.user.name %>
                    <% end %>
                    さんが<%= article.updated_at.strftime("%Y年%m月%d日").to_s %>に作成
                  </div>
                  <div>
                    <%= render 'users/favorite', article: article %>
                  </div>
                </div>
                <%= link_to article do %>
                  <h5 class="card-title article-title-text"><%= article.title %></h5>
                <% end %>
                <%= strip_tags(article.content.to_s).gsub(/[\n]/,"").truncate(100) %>
              </div>
            </div>
          </div>
        <% end %>
        <!-- kaminari ページネイション -->
        <%= paginate @favorite_articles %>
      </div>
      <!-- 作成した質問 -->
      <div class="tab-pane fade" id="questions" role="tabpanel" aria-labelledby="questions-tub">
        <% @questions.each do |question| %>
          <div class="card-custom">
            <div class="card-body">
              <div class="author-header contents-tidy">
                <div>
                  <%= link_to user_path(question.user_id) do %>
                    <% if question.user.profile? %>
                      <span style="margin-right: 5px;"><%= image_tag question.user.profile.url, class: "navber-profile-icon" %></span>
                    <% else %>
                      <span style="margin-right: 5px;"><%= image_tag '/assets/profile_defalt.png', class: "navber-profile-icon" %></span>
                    <% end %>
                    <%= question.user.name %>
                  <% end %>
                  さんが<%= question.updated_at.strftime("%Y年%m月%d日").to_s %>に作成 
                </div>         
              </div>
              <%= link_to question do %>
                <h5 class="card-title article-title-text"><%= question.title %></h5>
              <% end %>
              <%= strip_tags(question.content.to_s).gsub(/[\n]/,"").truncate(100) %>
            </div>
          </div>
        <% end %>
        <!-- kaminari ページネイション -->
        <%= paginate @questions %>
      </div>
      <!-- 回答した質問 -->
      <div class="tab-pane fade" id="answers" role="tabpanel" aria-labelledby="answers-tub">
        <% @answers.each do |answer| %>
          <div class="card-custom">
            <div class="card-body">
              <div class="author-header contents-tidy">
                <div>
                  <%= link_to user_path(answer.user_id) do %>
                    <% if answer.user.profile? %>
                      <span style="margin-right: 5px;"><%= image_tag answer.user.profile.url, class: "navber-profile-icon" %></span>
                    <% else %>
                      <span style="margin-right: 5px;"><%= image_tag '/assets/profile_defalt.png', class: "navber-profile-icon" %></span>
                    <% end %>
                    <%= answer.user.name %>
                  <% end %>
                  さんが<%= answer.updated_at.strftime("%Y年%m月%d日").to_s %>に作成 
                </div>         
              </div>
              <%= link_to answer do %>
                <h5 class="card-title article-title-text"><%= answer.title %></h5>
              <% end %>
            </div>
          </div>
        <% end %>
        <!-- kaminari ページネイション -->
        <%= paginate @answers %>
      </div>
    </div>
  </div>
</div>
